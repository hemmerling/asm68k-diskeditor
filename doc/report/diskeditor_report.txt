file: sDISKDOC
      Dokumentation zum RTOS DISK EDITOR FUER ATARI ST
      Rolf Hemmerling, 1988-05-12
 
COMPILIERUNGSVORGANG FUER DEN DISKEDITOR:
-----------------------------------------
CD F0:
COPY ED:sINCLAS SC=ED:sDISKAS > ED:SIA
-- AS SZ=6000 CO=ED:SR1 LO=NO SI=ED:SIA
-- P ED:sDISK
-- LOAD ED:SR+ED:SR1
 
 
AUFLISTUNG ALLER TASKS (ALLE ZUM START DURCH DEN BENUTZER VORGESEHEN)
---------------------------------------------------------------------
 
NEUE BEFEHLE:
-------------
DISKEDIT      - MENUE, ZUM EINSTELLEN ALLER PARAMETER
CLEARBUFFER   - INTERNEN BUFFER AUF $00 SETZEN
READADDRESS   - DISK ID-FELDER LESEN, ANSEHEN MIT DISKEDIT,
                OPTION "SHOW ADDR FIELDS.." AUSWAEHLEN
READTRACK     - MIT DISKEDIT EINGESTELLTE SPUR LESEN (MIT SYNCS,..)
                WIE IN (1) BESCHRIEBEN, FUNKTIONIERT DIESE FUNKTION
                DES FDC-CONTROLLERS SO GUT WIE UEBERHAUPT NICHT !
READSECTOR    - MIT DISKEDIT EINGESTELLTEN SEKTOR EINER SPUR LESEN
READMSECTORS  - DITO AUFEINANDERFOLGENDE SEKTOREN LESEN (1,..5)
WRITETRACK    - FORMATTIEREN EINES TRACKS, ACHTUNG: DAZU MUSS SICH EINE
                GEEIGNETE BYTEKOMBINATION IM BUFFER BEFINDEN !
WRITESECTOR   - MIT DISKEDIT EINGESTELLTEN SEKTOR SCHREIBEN AUS BUFFER
WRITEMSECTORS - DITO AUFEINANDERFOLGENDE SEKTOREN AUS BUFFER SCHREIBEN
GETCTRACK     - SPURKENNUNG DER GERADE EINGESTELLTEN SPUR LESEN,
                DANACH DISKEDIT AUFRUFEN, SECTORREGISTER ENTHAELT
                DIE SPUR-NUMMER
FSTEP         - STEP IN SELBE RICHTUNG (WIE BEIM STEP VORHER)
FSTEPIN       - STEP ZU GROESSEREN SPURNUMMERN
FSTEPOUT      - STEP ZU KLEINEREN SPURNUMMERN
 
VORHANDENE HILFSMITTEL DES SYSTEMS:
-----------------------------------
MONI          - MONITOR, VON DER UTILITY DISKETTE NACHZULADEN,
MONITOR       - MONITOR, SCHON BEIM START IM SPEICHER
DM,SM,S       - SHELL-BEFEHLE
 
RUECKGABESTATUS:
---------------
DIE ALLERMEISTEN BEFEHLE GEBEN EINEN HEXADEZIMALEN 16-BIT STATUS 
ZURUECK. DAS HIGH-BYTE ENTSPRICHT DEM DMA-STATUS (BIT 10,9,8), DAS 
LOW-BYTE DEM DES FLOPPY-CONTROLLER STATUS (BIT 7-0)
DA DIE ALLERMEISTEN BITS BEIM LESEN DES FDC STATUS BYTES ZURUECKGESETZT
WERDEN, ZEIGT DER PUNKT FDC/DMA STATUS IM MENUE VON DISKEDIT DEN
NEU ERMITTELTEN STATUS AN, NICHT DENJENIGEN, DER BEI DER LETZTEN
OPERATION ZURUECKGEGEBEN WURDE.
 
DATEN ANSEHEN/MODIFIZIEREN:
---------------------------
- ZU ALLERERST:
  DEN BENUTZERN AN DEN ANDEREN TERMINALS MITTEILEN, DASS
  MAN DIESES PROGRAMM ZU BENUTZEN WUENSCHT.
  A) GEWUENSCHTE BZW. ERWARTETE REAKTION:
  DIE BENUTZER VERLASSEN FLUCHTARTIG DEN
  RAUM ZUR KAFFEEPAUSE, NACHDEM SIE IHRE DATEN GESICHERT HABEN,UND IHRE DISKETTEN AUS DEN LAUFWERKEN ENTFERNT HABEN.
  B) UNERWUENSCHTE, ABER AUSREICHENDE REAKTION:
  DIE BENUTZER LOGGEN SICH AUF DEN ED-FILEMANAGER EIN
  UND SCHWOEREN SICH, BIS ZUM ENDE DER DISKEDIT-SITZUNG
  AUF KEINEN FALL AUF EINE DER AM DMABUS ANGESCHLOSSENEN GERAETE
  (FLOPPYS, WINCHESTER,..) ZUZUGREIFEN.
 
  NUN ENTFERNT MAN DIE RESTLICHEN RTOS-DISKETTEN AUS DEN LAUFWERKEN,
  LEGE DIE ZU MODIFIZIERENDE DISKETTE IN EIN LAUFWERK EIN,
  LOGGE SICH EBENFALLS MIT "CD ED:" AUF DEN ED-FILEMANAGER EIN.
 
  ANMERKUNG: WAEHREND DES DIREKTEN FLOPPY-ZUGRIFFS WIRD DER
  UH-FILEMANAGER "SUSPENDIERT". GIBT ES EINEN PROGRAMMABBRUCH
  WAEHREND DER AUSFUEHRUNG EINER DER DISKEDIT-TASKS, SO RESTAURIERE
  MAN ZUNAECHST MIT EINEM WARMSTART (SHIFT-UNDO) DIE UH-FM VEKTOREN
  IM SPEICHER. DANACH KANN AUF DIE DMA-GERAETE ZUGEGRIFFEN WERDEN.
 
- AUFRUF VON DISKEDIT, UM DIE PARAMETER EINZUSTELLEN.
  ACHTUNG, RTOS- UND TOS-DISKETTEN HABEN KEINEN SEKTOR 0, WOHL
  ABER OS-9 DISKETTEN
  MIT "0" AUS DISKEDIT HERAUSGEHEN
- READSECTOR, READTRACK,READMSECTORS ..
  LESEKOMMANDO EINGEBEN
  AUF RUECKGABESTATUS ACHTEN, UND BEWERTEN (IM KOPF!)
- UM SICH DIE MIT READTRACK,.. EINGELESENEN DATEN ANZUSEHEN, RUFE
  MAN DISKEDIT AUF, VERLASSE ES MIT "0" .
  ANGEZEIGT IST NUN DER BEGINN DES BUFFERS, SOWIE DAS ENDE DES
  GUELTIGEN DATENBEREICHS (DMA-ENDADRESSE).
  ES IST BEI READSECTOR,READMSECTORS,READTRACK,WRITESECTOR,
  WRITEMSECTORS,WRITETRACK ETWAS SCHIEFGEGANGEN, FALLS ANFANGS-
  GLEICH ENDADRESSE. DANN WURDEN NAEMLICH KEINE BYTES UEBERTRAGEN !
- NUN RUFE MAN MONI AUF, GEBE DEN BEFEHL "DM" MIT DER BUFFERADRESSE
  ALS ANFANGSADRESSE, UND EINER ENDADRESSE EIN.
  ANSCHLIESSENDES ANZEIGEN UND MODIFIZIEREN NACH BELIEBEN
- ANSTATT SICH DIE BUFFER-ANFANGSADRESSE MIT DISKEDIT ZU VERSCHAFFEN,
  KANN MAN MIT DEM S-BEFEHL DER SHELL AUCH DIE ADRESSE DES MODULS
  "BUFFER" ERMITTELN, AB OFFSET $0010 (ALSO NACH DEM MODULKOPF)
  STEHEN DIE DATEN IM SPEICHER.
- BEVOR MAN (1) NICHT GELESEN UND VERSTANDEN HAT, SEI VOR ALLEN
  SCHREIBBEFEHLEN DRINGEND ABGERATEN.
 
 
 
 
LITERATUR
---------
- (1)
  BRAUN,DITTRICH,SCHRAMM
  ATARI ST - FLOPPY UND HARDDISK
  DATA BECKER
  ISBN 3-89011-132-7

  MAN KANN ZU (1) EINE DISKETTE MIT ALLEN SOURCE- UND CODE-FILES ERHALTEN (29 DM,DATA BECKER). DER DARAUF ENTHALTENE EINFACHE DISKETTENEDITOR "DISK_MON" IST IN DER LAGE, OS-9 UND RTOS DISKETTEN ZU LESEN UND ZU SCHREIBEN. ER FUNKTIONIERT NUR UNTER DEM ALTEN ROM-TOS, NICHT ABER UNTER DEM NEUEN BLITTER-ROM-TOS, WIE SO VIELES ANDERE AUCH. LEIDER VERFUEGT ER NICHT UEBER SUCHFUNKTIONEN O. AE.

  MIR IST ZUR ZEIT KEIN ANDERER DISKETTENEDITOR BEKANNT, MIT DEM MAN RTOS DISKETTEN BEARBEITEN KANN.

  MEIN TIP: OHNE DIESES BUCH IST MEIN PROGRAMM NUR SCHWER
  NACHVOLLZIEHBAR ODER AUCH NUR UNGEFAEHRLICH NUTZBAR, ALSO UNBEDINGT ZUR HAND HABEN, ZUR NOT IN DER OERTLICHEN STADTBIBLIOTHEK AUSLEIHEN ODER IN DER FERNLEIHE BESTELLEN. OHNE DIES GEHT NIX !!

- (2)
  BRUECKMANN,ENGLISCH,GERITS
  ATARI ST - INTERN
  DATA BECKER
  ISBN 3-89011-119-X
 
- (3)
  WESTERN DIGITAL WD 1770/1772  5 1/4 FLOPPY DISK CONTROLLER/FORMATTER
  DATA SHEET
  BEZUG Z.B. VON ELEKTRONIK 2000, STAHLGRUBERRING 12,8000 MUENCHEN 82
 
  (ANMERKUNG: WD 1772 IST DUEMMER ALS DER REST DER FAMILIE, UND VIEL DUEMMER ALS DER IM IBM PC SITZENDE NEC 765, DAHER ABER AUCH EINFACHER ZU PROGRAMMIEREN)
 
- (4)
  MAX BOEHM
  DER DMA PORT DES ATARI ST
  C'T 3/1988, SEITE 265
 
  (! ACHTUNG, DER AUTOR IRRT AN EINER STELLE, BIT 6 UND 7 SIND
  VERTAUSCHT GEGENUEBER SEINEN ANMERKUNGEN !?!)
 
- (5)
  TILMANN REH
  CP/M GOES MSDOS
  C'T 12/1987
  (LESEN UND SCHREIBEN VON MSDOS-DISKETTEN UNTER CP/M)
 
- (6)
  MATTHIAS RUETHER
  ULRICH RUETHER:
  ZWISCHEN DEN SYSTEMEN
  (LESEN UND SCHREIBEN VON CP/M DISKETTEN UNTER MSDOS)
 
- (7)
  P. SAWATZKI:
  TURBO LIEST UCSD
  AUGE MAGAZIN 2/1985
  (LESEN VON UCSD DISKETTEN UNTER CP/M, HIER FUER APPLE II+)
 
- (8)
  HOLGER PETERSEN,AXEL UNTERSCHUETZ:
  C'T  6/1985
  CHAOS MIT SYSTEM - DISKETTEN FORMATE UNTER CP/M
  (BESCHREIBUNG VERSCHIEDENER DISKETTENFORMATE)
 
- (9)
  RTOS/PEARL BENUTZERHANDBUCH
  E-II-1:  RTOS-UH FLOPPY/WINCHESTER-FILESYSTEM
  B-II-29: FORMATTING OF A FLOPPY/WINCH.(UH-FMAN)
  (DIE DISKETTENSTRUKTUR VON RTOS-UH WIRD HIER BESCHRIEBEN)
 
 
BESCHREIBUNG,NOTIZEN
--------------------
- KERNSTUECK DIESES PROGRAMMS SIND DIE FLOPPYROUTINEN, DIE
  DURCH AUSNUTZUNG DER SELBSTSUSPENDIERUNG DURCH DEN KOMMANDO-ENDE INTERRUPT DES FLOPPY-CONTROLLERS FORTGESETZT WERDEN. (SO
  FUNKTIONIERT Z.B AUCH OS-9, DAS BIS IN ALLE EWIGKEITEN WARTET, WENN BEI "DIR" KEINE DISKETTE IM LAUFWERK IST, UND DAZU NOCH DIE SHELL SPERRT !)
- DIE ROUTINEN SIND ALS HYPERPROZESSOR- "PROZEDUREN" GESCHRIEBEN, DAMIT MODULARER AUFBAU, UND AUFRUFMOEGLICHKEIT DER EINZELNEN PROZEDUREN VON HOCHSPRACHE AUS.
- ZUR ZEIT IST DAS PROCEDURE WORKSPACE SO DEFINIERT, DASS
  QUERSPRUENGE AUF ASSEMBLEREBENE (OHNE HYPERPROZESSOR)
  KONFLIKTFREI MOEGLICH SIND. SO IST FUER ALLE VARIABLEN
  EIN EIGENER PLATZ IN JEDEM WORKSPACE VORHANDEN, UEBERSCHNEIDUNGEN KOENNEN SICH LEDIGLICH AUS DER UEBERLAPPUNG GLEICHER VARIABLEN, Z.B. DER STATUSRUECKGABE (FDCERR.X) ERGEBEN. DAS WIRD ABER ZUR ZEIT NICHT GENUTZT, ES GIBT KEINE QUERSPRUENGE.
- DIESES PROGRAMM IST EIN (SCHLECHTES ?) BEISPIEL FUER DIE EINBINDUNG VON ASSEMBLER-ROUTINEN IN PEARL-RAHMENPROGRAMME. DIE ASSEMBLERPROGRAMMIERUNG WAR NOETIG, DA MAN NUR AUF ASSEMBLEREBENE IN DEN SUPERVISOR MODE KOMMT, UM AUF DIE (GESCHUETZTEN) FLOPPY/DMA REGISTER ZUGREIFEN ZU KOENNEN, UND NATUERLICH AUS GESCHWINDIGKEITSGRUENDEN. (UNTER TOS UND OS/9 KOENNEN AUCH HOCHSPRACHEN-PROGRAMME IM SUPERVISORMODE ABLAUFEN)
- DAS PROGRAMM WAERE UEBERFLUESSIG, WENN ES EINEN (VEROEFFENTLICHTEN) EINSPRUNGPUNKT (ODER GAR BETRIEBSSYSTEMS-AUFRUF) GAEBE, MIT DEM MAN (WIE BEI PRAKTISCH ALLEN ANDEREN MIKROPROZESSOR-BETRIEBSSYSTEMEN VORHANDEN) AUF JEDES EINZELNE BYTE EINER DISKETTE ZUGREIFEN KOENNTE. FREMDFORMATE MIT ANDEREN SEKTORLAENGEN WAEREN SO ABER WAHRSCHEINLICH NICHT ZUGAENGLICH. (OS-9: ZUGRIFF AUF /D0, UCSD: PASCAL BLOCKREAD-BEFEHLE, IBM PC: PROGRAMMIERUNG AUF ROM-BIOS-EBENE, CP/M: BIOS-FUNKTIONEN, MINIX: ZUGRIFF AUF /DEV/FD0,...)
- DAS PROGRAMM IST IM WESENTLICHEN VOM IN (1) ABGEDRUCKTEN DISKETTEN-EDITOR "DISK_MON" INSPIRIERT WORDEN
 
MOEGLICHE SINNVOLLE ERWEITERUNGEN
---------------------------------
- LESEN UND SCHREIBEN ANDERER DISKETTENFORMATE / DISKETTEN
  ANDERER BETRIEBSSYSTEME (TOS, CP/M 80 + CP/M 68K, UCSD,
  MSDOS, OS-9, MIRAGE, MINIX)
  (ANMERKUNG: DAS LESEN UND SCHREIBEN VON MSDOS DISKETTEN
  IST FUER DIE NAECHSTE RTOS VERSION IM HERBST 1988 VERSPROCHEN WORDEN)
  LITERATUR: (5),(6),(7)
 
- DISK-UTILITYS FUER RTOS:
  ABM-BELEGUNG, DIRECTORY ANZEIGE GEMAESS DIRECTORY,
  ODER GEMAESS LINKED-LISTS ODER UNTERSCHIEDE ZWISCHEN BEIDEN, UNERASE)
 
- ANDERE ARTEN DES FLOPPYZUGRIFFS (KEIN "HAENGEN" MEHR
  BEI FEHLENDER DISKETTE), MIT UEBERWACHUNGSTASK O. AE.
  EIGENTLICH IST DAS "HAENGEN" SEHR PEINLICH, ABER WAS SOLL'S,
  AUCH MIT "HAENGEN" FUNKTIONIERT DISKED JA LEIDLICH.
 
- SCHNELLES KOPIERPROGRAMM (MULTITRACK-BUFFER, FUER GROESSERER PUFFER
  BZW. ANDERE PUFFERVERWALTUNG MUESSTE ASM-FILE GEAENDERT WERDEN)
- FORMATTIERUNGS-UNTERSTUETZUNG
  A) DURCH KOPIERBEFEHLE, UM DIE ZUM
  FORMATTIEREN NOETIGEN DATENSTRUKTUREN IN DEN PUFFER HEREINZUBRINGEN
  (1024,512,256,128 BYTES/TRACK)
  B) FORMAT BEFEHL, DER DAS FORMATTIEREN (WRITETRACK,STEP,SIDESELECT)
  IN EINEM DURCHFUEHRT, UND DABEI VARIABEL PRO TRACK IN EINER LISTE
  DIE ANZAHL VON SEKTOREN,SEKTORGROESSE ECT. FUEHRT. ("KOPIERSCHUTZ",
  "UNMOEGLICHES FORMAT"
 
- ERWEITERUNGEN UND VERBESSERUNGEN SOWIE KOMMENTARE (AM BESTEN DOUBLE
  SIDED 3.5 ZOLL ATARI DISK) AN:
 
ROLF HEMMERLING






